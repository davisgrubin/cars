<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Gelman Exercises Chapter 2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Gelman Multilevel & Hierarchical Modeling Solutions</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="ch2.html">Chapter 2</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Gelman Exercises Chapter 2</h1>

</div>


<h1>
Question 1
</h1>
<p>1.A test is graded from 0 to 50, with an average score of 35 and a std. deviation of 10. For comparison of tests, it would be convenient to rescale to a mean of 100 and standard deviation of 15.</p>
<h2>
a)
</h2>
<p>How can the scores be linearly transformed to have this new mean and standard deviation?</p>
<p>Changing the mean of the scores only requires addition (shifting the distribution to the right), and doesn’t require a change in scaling, while changing the variance/std deviation will require multiplication that will effect the mean. Because of this, I’ve decided to scale the scores to adjust the std.deviation first and to then adjust the mean of the distribution as needed.</p>
<pre><code>Effect on variance of linear transformation:</code></pre>
<p><span class="math display">\[Y = aX + b \\ \sigma^{2} = (x_{i} - \mu_{x})^{2}/n \\ (ax_{i} - (ax_{i}/n))^{2}/n \\ (ax_{i} - a\mu_{x})^{2}/n \\ a^{2}x_{i}^{2} - a^{2}\mu_{x}^{2}/n \\ a^{2}(x_{i} - \mu_{x})^{2}/n \\ a^2\sigma^2  \]</span> Solving for linear transformation to desired variance: <span class="math display">\[\sigma = 10 \\ \sigma^{2} = 100 \\ a^{2}100 = 225 \\ a=1.5\]</span> Now plugging in for transformation for desired mean: <span class="math display">\[a\mu + b = 100 \\ 1.5*35 + b = 100 \\ b = 47.5  \]</span> Checking in R to see if these are correct:</p>
<pre class="r"><code>library(distr)
test_scores &lt;- Norm(mean = 35, sd = 10)
1.5 * test_scores + 47.5</code></pre>
<pre><code>## Distribution Object of Class: Norm
##  mean: 100
##  sd: 15</code></pre>
<h2>
b)
</h2>
<p>There is another linear transformation that also rescales the scores to have mean 100 and std. deviation 15. What is it, and why would you <em>not</em> want to use it for this purpose?</p>
<p>Since standard deviation is an absolute measure, we could make <span class="math inline">\(a\)</span> = -1.5 , and adjust <span class="math inline">\(b\)</span> = 152.5 to achieve the desired <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> as seen below.</p>
<pre class="r"><code>-1.5 * test_scores + 152.5</code></pre>
<pre><code>## Distribution Object of Class: Norm
##  mean: 100
##  sd: 15</code></pre>
<p>However, this is undesirable because by multiplying the positive scores by a negative number, scores in the original group that were lower than others will be closer to zero, and after the transformation will be higher than a score that was originally higher before the transformation.</p>
<pre class="r"><code>should_be_lower = -1.5*(30) + 152.5
should_be_higher = -1.5*(35) + 152.5
msg1 &lt;- paste(c(&quot;was 30 before transformation: after transformation is&quot;), c(should_be_lower))
msg2 &lt;- paste(c(&quot;was 35 before transformation: after transformation is&quot;),c(should_be_higher))
cat(paste0(msg1,&quot;\n&quot;,msg2))</code></pre>
<pre><code>## was 30 before transformation: after transformation is 107.5
## was 35 before transformation: after transformation is 100</code></pre>
<h1>
Question 2
</h1>
<p>The following are the proportions of girl births in Vienna for each month in 1908 and 1909 (out of an average of 3900 births per month.)</p>
<pre class="r"><code>births &lt;- c(.4777,.4875,.4859,.4754,.4874,.4864,.4813,.4787,.4895,.4797,.4876,.4859,.4857,.4907,.5010,.4903,.4860,.4911,.4871,.4725,.4822,.4870,.4823,.4973)</code></pre>
<p>von Mises used these proportions to claim that the sex ratios were less variable than would be expected by chance.</p>
<h2>
a)
</h2>
<p>Compute the std. deviation of these proportions and compare to the std. deviation that would be expected if the sexes of babies were independently decided with a constant probability over the 24-month period.</p>
<pre class="r"><code>sd(births)</code></pre>
<pre><code>## [1] 0.006409724</code></pre>
<pre class="r"><code>#self-defined to check for understanding
sqrt(sum((mean(births) - births)^2)/(length(births) - 1))</code></pre>
<pre><code>## [1] 0.006409724</code></pre>
<p>This is a binomial probability model since there are only 2 possible outcomes - Male or Female. This means we can use the formula for calculating the std. deviation of a binomial distribution of proportions.</p>
<p><span class="math display">\[\sqrt{p * (1-p)/n}\\
n = 24 \\p= 0.485675\]</span> Calculating the std. deviation with the above formula we get the following:</p>
<pre class="r"><code>births_prop_sd &lt;- sqrt((mean(births) * (1-mean(births))) / 3900)
print(births_prop_sd)</code></pre>
<pre><code>## [1] 0.008003121</code></pre>
<p>From this we can see that the observed std. deviation of ~.006 is less than the expected standard deviation of ~.008 from a random binomial distribution.</p>
<h2>
b)
</h2>
<p>The actual and theoretical standard deviations from (a) differ, of course. Is this difference statistically significant? (Hint: under the randomness model, the actual variance should have a distribution with expected value equal to the theoretical variance, and proportional to a <span class="math inline">\(\chi^2\)</span> with 23 degrees of freedom)</p>
<pre class="r"><code>scale_factor &lt;- births_prop_sd^2/23 
sqrt(scale_factor * q(Chisq(df=23))(c(.025,.975)))</code></pre>
<pre><code>## [1] 0.005705265 0.010297197</code></pre>
<p>The above calculations take the confidence interval at the 5% significance level for a <span class="math inline">\(\chi^2\)</span> distribution with 23 degrees of freedom, then scales them down proportionally by a factor of <span class="math inline">\(d.o.f/\sigma^2\)</span>, following the hint in the question. Since the ~.006 observed std. deviation occurs within this confidence interval we can conclude that observed and theoretical standard deviations’ difference is not statistically significant.</p>
<h1>
Question 3
</h1>
<p>Demonstration of the Central Limit Theorem: let <span class="math inline">\(x = x_{1} + ... +x_{20}\)</span>, the sum of 20 independent Uniform(0,1) random variables. In R, create 1000 simulations of <span class="math inline">\(x\)</span> and plot their histogram. On the histogram, overlay a graph of the normal density function. Comment on any differences between the histogram and the curve.</p>
<pre class="r"><code>library(ggplot2)
sums_of_rvs &lt;- replicate(1000,sum(r(Unif(0,1))(20)))
df &lt;- data.frame(x = sums_of_rvs )
ggplot(df, aes(x = x)) + 
    geom_histogram(aes(y = ..density..,binwidth=10)) + 
    stat_function(
        fun = dnorm, 
        args = with(df, c(mean = mean(x), sd = sd(x)))
    )</code></pre>
<p><img src="ch2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>There don’t appear to be any particularly startling differences between the histogram and the normal curve, though if we were trying to get the most exact match possible changing around the binwidth might provide a more exact match.</p>
<h1>
Question 4
</h1>
<p>Distribution of averages and differences: the heights of men in the United States are approximately normally distributed with mean 69.1 inches and standard deviation 2.9 inches. The heights of women are apporcimately normally distributed with mean 63.7 in. and sd 2.7 in. Let <span class="math inline">\(x\)</span> be the average height of 100 randomly sampled men, nad <span class="math inline">\(y\)</span> be the average height of 100 randomly sampled women. In R, create 1000 simlations of <span class="math inline">\(x-y\)</span> and plot their histogram. Using the simulations, compute the mean and standard deviation of the distribution of <span class="math inline">\(x-y\)</span> and compare to their exact values.</p>
<pre class="r"><code>mens_height &lt;- Norm(mean=69.1,sd=2.9)
womens_height &lt;- Norm(mean=63.7, sd=2.7)
height_diff &lt;- replicate(1000,mean(r(mens_height)(100)) - mean(r(womens_height)(100)))
df &lt;- data.frame(x=height_diff)
ggplot(data=df, aes(x=x)) + geom_histogram(binwidth = .05)</code></pre>
<p><img src="ch2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>simulated &lt;- paste0(&quot;Mean of 1000 simulations is &quot;,mean(height_diff),&quot;. Std. deviation is &quot;,sd(height_diff))

theoretical_mean &lt;- mean(mens_height) - mean(womens_height)
theoretical_sd &lt;- sqrt(sd(mens_height)**2 + sd(womens_height)**2)
theoretical &lt;- paste0(&quot;Theoretical mean is &quot;,theoretical_mean,&quot;. &quot;,&quot;Std. deviation is &quot;,theoretical_sd)
cat(simulated,&quot;\n&quot;,theoretical)</code></pre>
<pre><code>## Mean of 1000 simulations is 5.37922647596153. Std. deviation is 0.399643531352712 
##  Theoretical mean is 5.39999999999999. Std. deviation is 3.96232255123179</code></pre>
<p>The mean of the simulated <span class="math inline">\(x-y\)</span> closely approximates the theoretical because of the large number of total simulations, both in the 100 draws each of x and y and the repetition of the operation 1000 times. However the variance the of the simulation is lower due to the fact that the mean of 100 draws is being subtracted rather than simply subtracting a single draw of x from another single draw of y. This would produce a result like that below:</p>
<pre class="r"><code>sd(r(mens_height)(1000) - r(womens_height)(1000))</code></pre>
<pre><code>## [1] 3.896999</code></pre>
<pre class="r"><code>mean(r(mens_height)(1000) - r(womens_height)(1000))</code></pre>
<pre><code>## [1] 5.2395</code></pre>
<p>In the simulation above <span class="math inline">\(x-y\)</span> is closer to the theoretical value of the variance (though slightly farther from the mean) due to the number of draws as mentioned above.</p>
<h1>
Question 5
</h1>
<p>Correlated random variables: suppose that the heights of husbands and wives have a correlation of 0.3. Let <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> be the heights of a married heterosexual couple chosen at random. What are the mean and standard deviation of the average height, <span class="math inline">\((x+y)/2\)</span> ?</p>
<p>Formulas for mean and variance of sum of correlated random variables:</p>
<p><span class="math display">\[ 
\sigma_{ax+by} = \sqrt{a^{2}\sigma_{x}^{2} + b^{2}\sigma_{y}^{2} + 2ab\rho\sigma_{x}\sigma_{y}} \\ 
\mu_{ax+by} = a\mu_{x} + b\mu_{y} \\
avg.height = x+y/2 = .5x + .5y \\
\rho = .3 , \mu_{x} = 69.1, \sigma_{x} = 2.9, \mu_{y} = 63.7, \sigma_{y} = 2.7,a=b=.5
\]</span></p>
<p>Using the above formulas and plugging in the given information from the question into R we get the following:</p>
<pre class="r"><code>couple_mean = .5*mean(mens_height) + .5*mean(womens_height)
couple_sd = sqrt(.5**2*sd(mens_height)**2 + .5**2*sd(womens_height)**2 + (2*.5*.5*.3*sd(mens_height)*sd(womens_height)))
cat(paste(&quot;The mean average height of a married couple (x+y/2) is&quot;,couple_mean,&quot;and the sd is&quot;,couple_sd,&quot;.&quot;))</code></pre>
<pre><code>## The mean average height of a married couple (x+y/2) is 66.4 and the sd is 2.25820725355314 .</code></pre>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
